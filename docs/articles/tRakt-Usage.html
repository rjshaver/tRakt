<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Using tRakt &bull; tRakt</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tRakt</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jemus42/tRakt">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using tRakt</h1>
                        <h4 class="author"><span class="citation">@jemus42</span></h4>
            
            <h4 class="date">2016-12-03 UTC</h4>
          </div>

    
    
<div class="contents">
<div id="first-step-loading-packages-and-trakt-tv-credentials" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#first-step-loading-packages-and-trakt-tv-credentials" class="anchor"> </a></body></html>First step: Loading packages and trakt.tv credentials</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tRakt)   <span class="co"># Sets credentials on startup</span>
<span class="kw">library</span>(dplyr)   <span class="co"># For convenience</span>
<span class="kw">library</span>(ggplot2) <span class="co"># For plotting (duh)</span>
<span class="kw">library</span>(knitr)   <span class="co"># for knitr::kable, used to render simple tables</span></code></pre></div>
</div>
<div id="lets-pull-some-data" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#lets-pull-some-data" class="anchor"> </a></body></html>Let&rsquo;s pull some data</h2>
<div id="search" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#search" class="anchor"> </a></body></html>Search</h3>
<p>There are two ways to search on trakt.tv. The first is via text query (i.e. <code>Game of Thrones</code>), the second is via ID (various types supported).</p>
<p>At the time of this writing (2015-02-16), the trakt.tv search is a little derpy, so search by ID is recommended.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Search via text query</span>
show1  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.search.html">trakt.search</a></span>(<span class="st">"Game of Thrones"</span>)

<span class="co"># Search via ID (trakt id is used by default)</span>
show2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.search.byid.html">trakt.search.byid</a></span>(<span class="dv">1390</span>) <span class="co"># trakt id of Game of Thrones</span>

<span class="co"># The returned data is identical</span>
<span class="kw">identical</span>(show1, show2)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="getting-more-data" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#getting-more-data" class="anchor"> </a></body></html>Getting more data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Search a show and receive basic info</span>
show          &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.search.html">trakt.search</a></span>(<span class="st">"Breaking Bad"</span>)
<span class="co"># Save the slug of the show, that's needed for other functions as an ID</span>
slug          &lt;-<span class="st"> </span>show$ids$slug
slug</code></pre></div>
<pre><code>## [1] "breaking-bad"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get the season &amp; episode data</span>
show.seasons  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.seasons.summary.html">trakt.seasons.summary</a></span>(slug, <span class="dt">extended =</span> <span class="st">"full"</span>) <span class="co"># How many seasons are there?</span>
show.episodes &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.get_all_episodes.html">trakt.get_all_episodes</a></span>(slug, show.seasons$season, <span class="dt">extended =</span> <span class="st">"full"</span>)

<span class="co"># Glimpse at data (only some columns each)</span>
show.seasons[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)] %&gt;%<span class="st"> </span>kable</code></pre></div>
<table class="table"><thead><tr class="header"><th></th>
<th align="left">season</th>
<th align="right">votes</th>
<th align="right">episode_count</th>
</tr></thead><tbody><tr class="odd"><td>2</td>
<td align="left">1</td>
<td align="right">922</td>
<td align="right">7</td>
</tr><tr class="even"><td>3</td>
<td align="left">2</td>
<td align="right">767</td>
<td align="right">13</td>
</tr><tr class="odd"><td>4</td>
<td align="left">3</td>
<td align="right">733</td>
<td align="right">13</td>
</tr><tr class="even"><td>5</td>
<td align="left">4</td>
<td align="right">691</td>
<td align="right">13</td>
</tr><tr class="odd"><td>6</td>
<td align="left">5</td>
<td align="right">805</td>
<td align="right">16</td>
</tr></tbody></table><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show.episodes[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">17</span>)] %&gt;%<span class="st"> </span><span class="kw">head</span>(<span class="dv">10</span>) %&gt;%<span class="st"> </span>kable</code></pre></div>
<table class="table"><thead><tr class="header"><th align="left">season</th>
<th align="right">episode</th>
<th align="left">title</th>
<th align="right">rating</th>
<th align="right">votes</th>
<th align="right">year</th>
</tr></thead><tbody><tr class="odd"><td align="left">1</td>
<td align="right">1</td>
<td align="left">Pilot</td>
<td align="right">8.48444</td>
<td align="right">4370</td>
<td align="right">2008</td>
</tr><tr class="even"><td align="left">1</td>
<td align="right">2</td>
<td align="left">Cat&rsquo;s in the Bag&hellip;</td>
<td align="right">8.26765</td>
<td align="right">3385</td>
<td align="right">2008</td>
</tr><tr class="odd"><td align="left">1</td>
<td align="right">3</td>
<td align="left">&hellip;And the Bag&rsquo;s in the River</td>
<td align="right">8.15347</td>
<td align="right">3043</td>
<td align="right">2008</td>
</tr><tr class="even"><td align="left">1</td>
<td align="right">4</td>
<td align="left">Cancer Man</td>
<td align="right">8.13089</td>
<td align="right">2949</td>
<td align="right">2008</td>
</tr><tr class="odd"><td align="left">1</td>
<td align="right">5</td>
<td align="left">Gray Matter</td>
<td align="right">8.09129</td>
<td align="right">2892</td>
<td align="right">2008</td>
</tr><tr class="even"><td align="left">1</td>
<td align="right">6</td>
<td align="left">Crazy Handful of Nothin&rsquo;</td>
<td align="right">8.66801</td>
<td align="right">2982</td>
<td align="right">2008</td>
</tr><tr class="odd"><td align="left">1</td>
<td align="right">7</td>
<td align="left">A No-Rough-Stuff-Type Deal</td>
<td align="right">8.51350</td>
<td align="right">2888</td>
<td align="right">2008</td>
</tr><tr class="even"><td align="left">2</td>
<td align="right">1</td>
<td align="left">Seven Thirty-Seven</td>
<td align="right">8.25441</td>
<td align="right">2775</td>
<td align="right">2009</td>
</tr><tr class="odd"><td align="left">2</td>
<td align="right">2</td>
<td align="left">Grilled</td>
<td align="right">8.47679</td>
<td align="right">2779</td>
<td align="right">2009</td>
</tr><tr class="even"><td align="left">2</td>
<td align="right">3</td>
<td align="left">Bit by a Dead Bee</td>
<td align="right">8.08871</td>
<td align="right">2604</td>
<td align="right">2009</td>
</tr></tbody></table></div>
</div>
<div id="some-example-graphs" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#some-example-graphs" class="anchor"> </a></body></html>Some example graphs</h2>
<p>Plotting the data is pretty straight forward since I try to return regular <code>data.frames</code> without unnecessary ambiguitiy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show.episodes$episode_abs &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(show.episodes) <span class="co"># I should probably do that for you.</span>
show.episodes %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> episode_abs, <span class="dt">y =</span> rating, <span class="dt">colour =</span> season)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">colour =</span> <span class="st">"black"</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se =</span> F) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Trakt.tv Ratings of Breaking Bad"</span>, 
         <span class="dt">y =</span> <span class="st">"Rating"</span>, <span class="dt">x =</span> <span class="st">"Episode (absolute)"</span>, <span class="dt">colour =</span> <span class="st">"Season"</span>)</code></pre></div>
<p><img src="tRakt-Usage_files/figure-html/Graphing_1-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show.episodes %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> episode_abs, <span class="dt">y =</span> votes, <span class="dt">colour =</span> season)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">colour =</span> <span class="st">"black"</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Trakt.tv User Votes of Breaking Bad Episodes"</span>, 
         <span class="dt">y =</span> <span class="st">"Votes"</span>, <span class="dt">x =</span> <span class="st">"Episode (absolute)"</span>, <span class="dt">colour =</span> <span class="st">"Season"</span>)</code></pre></div>
<p><img src="tRakt-Usage_files/figure-html/Graphing_1-2.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show.episodes %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> episode_abs, <span class="dt">y =</span> <span class="kw">scale</span>(rating), <span class="dt">fill =</span> season)) +
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">position =</span> <span class="st">"dodge"</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Trakt.tv User Ratings of Breaking Bad Episodes</span><span class="ch">\n</span><span class="st">(Scaled using mean and standard deviation)"</span>, 
         <span class="dt">y =</span> <span class="st">"z-Rating"</span>, <span class="dt">x =</span> <span class="st">"Episode (absolute)"</span>, <span class="dt">fill =</span> <span class="st">"Season"</span>)</code></pre></div>
<p><img src="tRakt-Usage_files/figure-html/Graphing_1-3.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div id="now-some-user-specific-data" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#now-some-user-specific-data" class="anchor"> </a></body></html>Now some user-specific data</h2>
<p>User-specific functions (<code>trakt.user.*</code>) default to <code>user = getOption("trakt.username")</code>, which should have been set by <code><a href="../reference/get_trakt_credentials.html">get_trakt_credentials()</a></code>, so you get your own data per default.<br>
However, you can specifiy any publicly available user. Note that OAuth2 is not supported, so by &ldquo;publicly available user&rdquo;, I really mean only non-private users.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get a detailed list of shows/episodes I watched</span>
myeps    &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.user.watched.html">trakt.user.watched</a></span>(<span class="dt">user =</span> <span class="st">"jemus42"</span>, <span class="dt">type =</span> <span class="st">"shows.extended"</span>)

<span class="co"># Get a feel for the data</span>
myeps %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(last_watched_at)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span>kable</code></pre></div>
<table class="table"><thead><tr class="header"><th align="left">title</th>
<th align="right">season</th>
<th align="right">episode</th>
<th align="right">plays</th>
<th align="left">last_watched_at</th>
<th align="right">last_watched.year</th>
</tr></thead><tbody><tr class="odd"><td align="left">Shameless</td>
<td align="right">7</td>
<td align="right">9</td>
<td align="right">1</td>
<td align="left">2016-12-03 21:08:58</td>
<td align="right">2016</td>
</tr><tr class="even"><td align="left">Humans</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="left">2016-12-03 20:18:03</td>
<td align="right">2016</td>
</tr><tr class="odd"><td align="left">QI</td>
<td align="right">14</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="left">2016-12-03 19:31:11</td>
<td align="right">2016</td>
</tr><tr class="even"><td align="left">The Angry Beavers</td>
<td align="right">4</td>
<td align="right">26</td>
<td align="right">1</td>
<td align="left">2016-12-03 18:30:00</td>
<td align="right">2016</td>
</tr><tr class="odd"><td align="left">The Angry Beavers</td>
<td align="right">4</td>
<td align="right">13</td>
<td align="right">1</td>
<td align="left">2016-12-03 18:01:01</td>
<td align="right">2016</td>
</tr></tbody></table><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># &hellip;and the movies in my trakt.tv collection</span>
mymovies &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trakt.user.collection.html">trakt.user.collection</a></span>(<span class="dt">user =</span> <span class="st">"jemus42"</span>, <span class="dt">type =</span> <span class="st">"movies"</span>)

mymovies %&gt;%
<span class="st">  </span><span class="kw">select</span>(title, year, collected_at) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(collected_at) %&gt;%
<span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) %&gt;%
<span class="st">  </span>kable</code></pre></div>
<table class="table"><thead><tr class="header"><th align="left">title</th>
<th align="right">year</th>
<th align="left">collected_at</th>
</tr></thead><tbody><tr class="odd"><td align="left">In Bruges</td>
<td align="right">2008</td>
<td align="left">2014-08-28 15:33:23</td>
</tr><tr class="even"><td align="left">Pan&rsquo;s Labyrinth</td>
<td align="right">2006</td>
<td align="left">2014-08-28 15:33:24</td>
</tr><tr class="odd"><td align="left">Sleepy Hollow</td>
<td align="right">1999</td>
<td align="left">2014-08-28 15:33:24</td>
</tr><tr class="even"><td align="left">Primer</td>
<td align="right">2004</td>
<td align="left">2014-08-28 15:33:24</td>
</tr><tr class="odd"><td align="left">Pacific Rim</td>
<td align="right">2013</td>
<td align="left">2014-08-28 15:33:24</td>
</tr></tbody></table><p>I tried my best to make the returned data as flat and usable as possible.<br>
I <em>tried</em>.</p>
<p>So, well, let&rsquo;s see: Take watched shows, diff the oldest and youngest <code>lastwatched</code> values to get something like a &ldquo;watch duration&rdquo; going and aggregate using it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myeps %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(title) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">days =</span> <span class="kw">as.numeric</span>(<span class="kw">round</span>(<span class="kw">max</span>(last_watched_at) -<span class="st"> </span><span class="kw">min</span>(last_watched_at)))) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(days)) %&gt;%
<span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) %&gt;%
<span class="st">  </span>kable</code></pre></div>
<table class="table"><thead><tr class="header"><th align="left">title</th>
<th align="right">days</th>
</tr></thead><tbody><tr class="odd"><td align="left">Bob&rsquo;s Burgers</td>
<td align="right">1362</td>
</tr><tr class="even"><td align="left">The Walking Dead</td>
<td align="right">1362</td>
</tr><tr class="odd"><td align="left">American Dad!</td>
<td align="right">1356</td>
</tr><tr class="even"><td align="left">Family Guy</td>
<td align="right">1355</td>
</tr><tr class="odd"><td align="left">The Simpsons</td>
<td align="right">1355</td>
</tr><tr class="even"><td align="left">Suits</td>
<td align="right">1288</td>
</tr><tr class="odd"><td align="left">American Horror Story</td>
<td align="right">1285</td>
</tr><tr class="even"><td align="left">Adventure Time</td>
<td align="right">1154</td>
</tr><tr class="odd"><td align="left">South Park</td>
<td align="right">1134</td>
</tr><tr class="even"><td align="left">MythBusters</td>
<td align="right">1095</td>
</tr></tbody></table><p>It&rsquo;s data like this that makes me wish I had been using trakt.tv forever. The potential for interesting data is great, but the limit is, as usual, the source of the data.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#first-step-loading-packages-and-trakt.tv-credentials">First step: Loading packages and trakt.tv credentials</a></li>
      <li><a href="#lets-pull-some-data">Let&rsquo;s pull some data</a></li>
      <li><a href="#some-example-graphs">Some example graphs</a></li>
      <li><a href="#now-some-user-specific-data">Now some user-specific data</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Lukas Burk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
